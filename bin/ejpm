#!/usr/bin/env python3
import sys
import os
import inspect

if __name__ == '__main__':

    # make sure this command will work with ejpm in this dir
    ejpm_file_path = os.path.dirname(inspect.stack()[0][1])

    # Fixes the case if somebody set a link like ln -s /.../bin/ejpm /usr/bin/
    if os.path.islink(ejpm_file_path):
        ejpm_file_path = os.path.realpath(ejpm_file_path)

    ejpm_top_dir = os.path.dirname(ejpm_file_path)

    sys.path.insert(0, ejpm_top_dir)

    try:
        import ejpm

        # Run ejpm cli
        ejpm.ejpm_cli()
    except ModuleNotFoundError as ex:
        if 'appdirs' in str(ex):
            print("No module named 'appdirs'. Please install it. 'python3 -m pip install --user appdirs' should work")
